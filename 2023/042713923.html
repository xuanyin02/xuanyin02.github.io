<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="hive">
    
    <meta name="author" content="宣胤">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://xuanyin02.github.io/2023/042713923.html"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
        <meta name="description" content="hive在离线数据仓库中十分常用，那么hive是什么呢？有什么用？它是怎么工作的？怎么使用它？下面这篇文章将一一解答你的问题！ 第1章 hive入门1.1 什么是hivehive是基于hadoop的一个数据仓库工具，可以将结构化的数据文件映射为一张表，并提供类SQL查询功能（HQL）。 1)hive处理的数据存储在HDFS2)hive分析数据底层的实现是Mapreduce&#x2F;Spark（分">
<meta property="og:type" content="article">
<meta property="og:title" content="关于数据仓库hive知识的学习">
<meta property="og:url" content="http://xuanyin02.github.io/2023/042713923.html">
<meta property="og:site_name" content="宣胤星球">
<meta property="og:description" content="hive在离线数据仓库中十分常用，那么hive是什么呢？有什么用？它是怎么工作的？怎么使用它？下面这篇文章将一一解答你的问题！ 第1章 hive入门1.1 什么是hivehive是基于hadoop的一个数据仓库工具，可以将结构化的数据文件映射为一张表，并提供类SQL查询功能（HQL）。 1)hive处理的数据存储在HDFS2)hive分析数据底层的实现是Mapreduce&#x2F;Spark（分">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/xuanyin02/ImgHosting/article_img/hive%E6%9E%B6%E6%9E%84%E5%8E%9F%E7%90%86.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/xuanyin02/ImgHosting/article_img/image-20230427170924636.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/xuanyin02/ImgHosting/article_img/image-20230427182958022.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/xuanyin02/ImgHosting/article_img/image-20230427182914489.png">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/xuanyin02/ImgHosting/article_img/image-20230427183049077.png">
<meta property="article:published_time" content="2023-04-27T08:24:33.000Z">
<meta property="article:modified_time" content="2023-05-14T14:54:55.294Z">
<meta property="article:author" content="宣胤">
<meta property="article:tag" content="hive">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/xuanyin02/ImgHosting/article_img/hive%E6%9E%B6%E6%9E%84%E5%8E%9F%E7%90%86.png">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/Hopstarter.png" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/Hopstarter.png">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="/images/Hopstarter.png">
    <!--- Page Info-->
    
    <title>
        
            关于数据仓库hive知识的学习 -
        
        宣胤星球
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    
<link rel="stylesheet" href="/assets/fonts.css">

    <!--- Font Part-->
    
    
    
    

    <!--- Inject Part-->
    
    <script id="hexo-configurations">
    let Global = window.Global || {};
    Global.hexo_config = {"hostname":"xuanyin02.github.io","root":"/","language":"zh-CN","path":"search.xml"};
    Global.theme_config = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":true,"link_icon":true},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[""]},"code_block":{"copy":true,"style":"mac","font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":6,"number":true,"expand":true,"init_open":true},"copyright":true,"lazyload":true,"recommendation":{"enable":false,"title":"推荐阅读","limit":3,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":null},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":true},"scroll_progress":{"bar":false,"percentage":true},"busuanzi_counter":{"enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"pjax":true,"open_graph":true,"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/wallhaven-wqery6-light.webp","dark":"/images/wallhaven-wqery6-dark.webp"},"title":"欢迎你的到来","subtitle":{"text":["Loading..."],"hitokoto":{"enable":true,"api":"https://v1.hitokoto.cn/?c=f"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":"Noto Sans SC","url":"https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap"},"social_links":{"enable":false,"links":{"github":null,"instagram":null,"zhihu":null,"twitter":null,"email":null}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":true,"type":"fixed","audios":[{"name":"Imagine","artist":"Imagine","url":"https://evan.beee.top/music/Imagine%20-%20John%20Lennon.mp3","cover":"https://evan.beee.top/music/covers/Lennon_Imagine_Sleeve_1975.jpg"},{"name":"Something Just Like This","artist":"Coldplay","url":"https://evan.beee.top/music/Something%20Just%20Like%20This%20-%20The%20Chainsmokers%E3%80%81Coldplay.mp3","cover":"https://evan.beee.top/music/covers/Something_Just_Like_This.png"},{"name":"BABYDOLL (Speed)","artist":"Ari Abdul","url":"https://m801.music.126.net/20230520215924/bdbfb8b35cd4229412a73904dbdee55e/jdymusic/obj/wo3DlMOGwrbDjj7DisKw/13687553827/3a02/8257/d479/e223994abf0ba2e7f73730952b28727f.mp3","cover":"http://p2.music.126.net/jhjtPJ9HfOgX-G7MYl-yaQ==/109951167210282652.jpg?param=130y130"},{"name":"Empty Love","artist":"Lulleaux / Kid Princess","url":"https://m801.music.126.net/20230520215808/4864695176397817d7a4102bc2ca9131/jdymusic/obj/wo3DlMOGwrbDjj7DisKw/13261956536/467f/20e2/c32f/c06edbca060dba447cdfad9c9fb88aff.mp3","cover":"http://p1.music.126.net/xrWSChs7pIOWFjOz5eQIzw==/109951164855840145.jpg?param=130y130"},{"name":"年少有为","artist":"李荣浩","url":"https://m801.music.126.net/20230520220515/287096a2df84a07eeb1ae68297f24944/jdymusic/obj/wo3DlMOGwrbDjj7DisKw/17225790298/43a9/e061/9d08/22afe988a702e5f437367eccec684094.mp3","cover":"http://p1.music.126.net/tt8xwK-ASC2iqXNUXYKoDQ==/109951163606377163.jpg?param=130y130"},{"name":"不将就","artist":"李荣浩","url":"https://m701.music.126.net/20230520220740/945f27da98d4baa9fa2c68106a66c844/jdymusic/obj/wo3DlMOGwrbDjj7DisKw/17225469644/58af/3f2e/98bd/65a56f8a4dd6481bda5e738e4d406e33.mp3","cover":"http://p2.music.126.net/e-Uc6W3Kug-HFHJ5nvCUPg==/109951166562828988.jpg?param=130y130"},{"name":"起风了","artist":"买辣椒也用券","url":"https://m801.music.126.net/20230520221043/bb3bc523719e1796f40db9073feadd50/jdymusic/obj/wo3DlMOGwrbDjj7DisKw/14096462065/f8fb/560c/c15d/12a0db051a26b4001cb2db52d488a239.mp3","cover":"http://p2.music.126.net/diGAyEmpymX8G7JcnElncQ==/109951163699673355.jpg?param=130y130"},{"name":"忘不掉的你","artist":"h3R3","url":"https://m801.music.126.net/20230520221302/166a00a7fd0e367b5cfb83b1f1053fa8/jdymusic/obj/wo3DlMOGwrbDjj7DisKw/14096412060/add8/8868/addf/16aaffa8e47bfbe1fd4ce87e26c8cd52.mp3","cover":"http://p2.music.126.net/4BCskpY6Rmm-QReHnY8W6Q==/109951166071009318.jpg?param=130y130"},{"name":"世间美好与你环环相扣","artist":"柏松","url":"https://m801.music.126.net/20230520221513/7a0cda7c270211488b2918168db169a0/jdymusic/obj/wo3DlMOGwrbDjj7DisKw/14096410267/0adb/e6bc/bb93/8937b88be6e4b2c38966e838a64173ad.mp3","cover":"http://p1.music.126.net/DK1_4sP_339o5rowMdPXdw==/109951164071024476.jpg?param=130y130"}]},"mermaid":{"enable":false,"version":"9.3.0"}},"version":"2.1.4","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"About":{"icon":"fa-regular fa-user","submenus":{"Me":"/about","Github":"https://github.com/xuanyin02","Blog":"https://xuanyin02.github.io/"}}},"search":{"enable":true,"preload":true},"tags":{"tags":{"icon":"fa-solid fa-tags","path":"/tags/"}},"categories":{"categories":{"icon":"fa-solid fa-folder","path":"/categories/"}}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":null,"links":{"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Tags":{"path":"/tags","icon":"fa-regular fa-tags"},"Categories":{"path":"/categories","icon":"fa-regular fa-folder"}}},"article_date_format":"auto","categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}}};
    Global.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"};
    Global.data_config = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/rss2.xml" title="宣胤星球" type="application/rss+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>
<div class="progress-bar-container">
    

    
        <span class="pjax-progress-bar"></span>
        <span class="pjax-progress-icon">
            <i class="fa-solid fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container">

    

    <div class="main-content-container">

        <div class="main-content-header">
            <header class="navbar-container">
    
    <div class="navbar-content">
        <div class="left">
            
                <a class="logo-image" href="/">
                    <img src="/images/Hopstarter.png">
                </a>
            
            <a class="logo-title" href="/">
                
                宣胤星球
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/"  >
                                    
                                        
                                            <i class="fa-regular fa-house"></i>
                                        
                                        首页
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/archives"  >
                                    
                                        
                                            <i class="fa-regular fa-archive"></i>
                                        
                                        归档
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown" 
                                    href="#" onClick="return false;">
                                    
                                        
                                            <i class="fa-regular fa-user"></i>
                                        
                                        关于&nbsp;<i class="fa-solid fa-chevron-down"></i>
                                    
                                </a>
                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                    
                                        <li>
                                        <a href="/about">ME
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a target="_blank" rel="noopener" href="https://github.com/xuanyin02">GITHUB
                                        </a>
                                        </li>
                                    
                                        <li>
                                        <a href="https://xuanyin02.github.io/">BLOG
                                        </a>
                                        </li>
                                    
                                    </ul>
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i></div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile drawer -->
    <div class="navbar-drawer">
        <ul class="drawer-navbar-list">
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="" 
                        href="/"  >
                             
                                
                                    <i class="fa-regular fa-house"></i>
                                
                                首页
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="" 
                        href="/archives"  >
                             
                                
                                    <i class="fa-regular fa-archive"></i>
                                
                                归档
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item flex-center">
                        <a class="has-dropdown" 
                        href="#" onClick="return false;">
                            
                                
                                    <i class="fa-regular fa-user"></i>
                                
                                关于&nbsp;<i class="fa-solid fa-chevron-down"></i>
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                              
                        
                            <li class="dropdown-item flex-center">
                                <a class="dropdown-item" href="/about">ME</a>
                            </li>
                        
                            <li class="dropdown-item flex-center">
                                <a class="dropdown-item" target="_blank" rel="noopener" href="https://github.com/xuanyin02">GITHUB</a>
                            </li>
                        
                            <li class="dropdown-item flex-center">
                                <a class="dropdown-item" href="https://xuanyin02.github.io/">BLOG</a>
                            </li>
                        
                    
            

        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="main-content-body">

            

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="post-page-container">
        <div class="article-content-container">

            
            
                <div class="article-title">
                    <h1 class="article-title-regular">关于数据仓库hive知识的学习</h1>
                </div>
            
                
            

            
                <div class="article-header">
                    <div class="avatar">
                        <img src="/images/avatar.jpg">
                    </div>
                    <div class="info">
                        <div class="author">
                            <span class="name">宣胤</span>
                            
                                <span class="author-label"></span>
                            
                        </div>
                        <div class="meta-info">
                            <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2023-04-27 16:24:33</span>
        <span class="mobile">2023-04-27 16:24</span>
        <span class="hover-info">创建</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2023-05-14 22:54:55</span>
            <span class="mobile">2023-05-14 22:54</span>
            <span class="hover-info">更新</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/hive/">hive</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fa-regular fa-typewriter"></i>&nbsp;<span>3.5k 字</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fa-regular fa-clock"></i>&nbsp;<span>13 分钟</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                        </div>
                    </div>
                </div>
            

            <div class="article-content markdown-body">
                <p>hive在离线数据仓库中十分常用，那么hive是什么呢？有什么用？它是怎么工作的？怎么使用它？下面这篇文章将一一解答你的问题！</p>
<h3 id="第1章-hive入门"><a href="#第1章-hive入门" class="headerlink" title="第1章 hive入门"></a>第1章 hive入门</h3><h4 id="1-1-什么是hive"><a href="#1-1-什么是hive" class="headerlink" title="1.1 什么是hive"></a>1.1 什么是hive</h4><p>hive是基于hadoop的一个数据仓库工具，可以将结构化的数据文件映射为一张表，并提供类SQL查询功能（HQL）。</p>
<p>1)hive处理的数据存储在HDFS<br>2)hive分析数据底层的实现是Mapreduce&#x2F;Spark（分布式运行框架）<br>3)执行程序运行在yarn上</p>
<h4 id="1-2-hive的优缺点"><a href="#1-2-hive的优缺点" class="headerlink" title="1.2 hive的优缺点"></a>1.2 hive的优缺点</h4><h5 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h5><ol>
<li>操作接口采用类SQL语法，提供快速开发的能力（简单、容易上手）</li>
<li>避免了去写Mapreduce，减少开发人员的学习成本</li>
<li>hive的执行<strong>延迟比较高</strong>，因此hive常用于数据分析，对实时性要求不高的场合（历史数据分析等）</li>
<li>hive优势在于处理大数据，对于处理小数据没有优势，因为hive的执行延迟比较高</li>
<li>hive支持用户<strong>自定义函数</strong>，用户可以根据自己的需求来实现自己的函数</li>
</ol>
<h5 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h5><ol>
<li><p>hive的HQL表达能力有限</p>
<p>（1）迭代式算法无法表达</p>
<p>（2）数据挖掘方面不擅长</p>
</li>
<li><p>hive的效率比较低</p>
<p>（1）hive自动生成的Mapreduce作业，通常情况下不够智能化</p>
<p>（2）hive调优比较困难，粒度较粗（快）</p>
</li>
</ol>
<h4 id="1-3-hive的应用场景"><a href="#1-3-hive的应用场景" class="headerlink" title="1.3 hive的应用场景"></a>1.3 hive的应用场景</h4><p>①hive不适合需要低延迟的应用<br>②hive不是为联机事务处理而设计的，hive不提供实时的查询和基于行级的数据更新操作<br>③hive的最佳使用场合是大数据集的批处理作业，如网络日志分析</p>
<h4 id="1-4-hive架构及工作原理"><a href="#1-4-hive架构及工作原理" class="headerlink" title="1.4 hive架构及工作原理"></a>1.4 hive架构及工作原理</h4><p><figure class="image-caption"><img lazyload src="/images/loading.svg" data-src="https://cdn.jsdelivr.net/gh/xuanyin02/ImgHosting/article_img/hive%E6%9E%B6%E6%9E%84%E5%8E%9F%E7%90%86.png" alt="image-20230427164622923"><figcaption>image-20230427164622923</figcaption></figure></p>
<ol>
<li><p>用户接口：Client</p>
<p>CLI（hive shell）、JDBC（java访问hive）、WEB UI（浏览器访问hive）</p>
</li>
<li><p>元数据：Metastore</p>
<p>元数据包括：表名、列名、分区、表属性等信息称为hive元数据</p>
<p>默认存储在内嵌的derby数据库中，推荐使用MySQL存储Metastore。为什么呢？<strong>因为derby只能允许一个会话连接，而MySQL支持多用户会话</strong></p>
<p>那为什么不存储在hdfs中呢？<strong>因为hive元数据可能面临不断更新、修改和读取，不适合使用hdfs进行存储</strong></p>
</li>
<li><p>Hadoop</p>
<p>使用hdfs进行存储，使用Mapreduce进行计算</p>
</li>
<li><p>驱动器：Driver</p>
<ul>
<li>解析器(SQLParser): 将HQL字符串转换成抽象语法树AST，这一步一般都用第三方工具库完成，比如antlr；对AST进行 语法 分析，比如表是否存在、字段是否存在、SQL语义是否有误</li>
<li>编译器(Compiler)： 对hql语句进行词法、语法、语义的编译(需要跟元数据关联)，编译完成后会生成一个执行计划。 hive上就是编译成mapreduce的job</li>
<li>优化器(Optimizer)： 将执行计划进行优化，减少不必要的列、使用分区、使用索引等。优化job</li>
<li>执行器(Executer): 将优化后的执行计划提交给hadoop的yarn上执行。提交job</li>
</ul>
</li>
</ol>
<h5 id="hive工作原理"><a href="#hive工作原理" class="headerlink" title="hive工作原理"></a>hive工作原理</h5><p>①由hive驱动模块中的编译器对用户输入的HQL语言进行词法和语法解析，将HQL语句转换成抽象语法树AST<br>②由于抽象语法树的结构仍很复杂，因此，把抽象语法树转化为查询块<br>③把查询块转换为逻辑查询计划，里面包含了许多逻辑操作符<br>④重写逻辑查询计划，进行优化，合并多余操作，减少Mapreduce任务数量<br>⑤将逻辑操作符转换为需要执行的具体的Mapreduce任务<br>⑥对生成的Mapreduce任务进行优化，生成最终的Mapreduce任务执行计划<br>⑦由hive驱动模块中的执行器对最终的Mapreduce任务进行执行输出</p>
<p><figure class="image-caption"><img lazyload src="/images/loading.svg" data-src="https://cdn.jsdelivr.net/gh/xuanyin02/ImgHosting/article_img/image-20230427170924636.png" alt="image-20230427170924636"><figcaption>image-20230427170924636</figcaption></figure></p>
<h4 id="1-5-hive和传统数据库比较"><a href="#1-5-hive和传统数据库比较" class="headerlink" title="1.5 hive和传统数据库比较"></a>1.5 hive和传统数据库比较</h4><ul>
<li>数据存储格式不同：hive没有专门的数据存储格式，只需要在创建表时指定数据的列分隔符和行分隔符，hive就可以解析数据；传统数据库的数据存储格式由系统预先定义</li>
<li>数据验证不同：hive在数据加载过程中不进行数据验证，而是在数据查询时才进行验证；传统数据库在数据加载时进行验证，因此hive加载数据比传统数据库快</li>
<li>DML操作不同：hive不支持数据更新操作，支持批量数据导入；传统数据库支持各种DML操作，支持数据更新、单条或批量数据导入</li>
<li>延迟性不同：hive操作延迟性高，不适合低延迟操作；传统数据库延迟性低，适合低延迟操作</li>
<li>数据规模不同：hive存储在hdfs中，利用Mapreduce进行并行计算，适合大规模数据操作；传统数据库主要采用本地文件系统存储数据，存在容量上限，在本地运行，数据处理能力有限</li>
</ul>
<h3 id="第2章-hive安装部署"><a href="#第2章-hive安装部署" class="headerlink" title="第2章 hive安装部署"></a>第2章 hive安装部署</h3><p>这里附上一篇链接，我就不进行赘述了</p>
<p>[参考文章]: <a class="link" target="_blank" rel="noopener" href="https://blog.csdn.net/W_chuanqi/article/details/130242723">https://blog.csdn.net/W_chuanqi/article/details/130242723 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>	“HIve安装配置（超详细）”</p>
<h3 id="第3章-hive数据类型"><a href="#第3章-hive数据类型" class="headerlink" title="第3章 hive数据类型"></a>第3章 hive数据类型</h3><h4 id="3-1-数据类型概述"><a href="#3-1-数据类型概述" class="headerlink" title="3.1 数据类型概述"></a>3.1 数据类型概述</h4><h5 id="3-1-1-基本数据类型"><a href="#3-1-1-基本数据类型" class="headerlink" title="3.1.1 基本数据类型"></a>3.1.1 基本数据类型</h5><p>TINYINT、SMALLINT、INT、BIGINT、BOOLEAN、FLOAT、DOUBLE、STRING、TIMESTAM-时间类型、BINARY-字节数组</p>
<h5 id="3-1-2-集合数据类型"><a href="#3-1-2-集合数据类型" class="headerlink" title="3.1.2 集合数据类型"></a>3.1.2 集合数据类型</h5><ul>
<li><p>STRUCT</p>
<p>和c语言中的struct类似，都可以通过“点”符号访问元素内容。例如，如果某个列的数据类型是STRUCT{first STRING, last STRING}，那么第1个元素可以通过字段’ .first ‘来引用</p>
</li>
<li><p>MAP</p>
<p>MAP是一组键-值对元组集合，使用数组标识法可以访问数据。例如，如果某个列的数据类型是MAP，其中键-&gt;值对是’ first ‘ -&gt;’ John ‘ 和 ‘ last ‘-&gt;’ Doe ‘，那么可以通过字段名[‘ last ‘]获取最后一个元素</p>
</li>
<li><p>ARRAY</p>
<p>数组是一组具有相同类型和名称的变量的集合。这些变量称为数组的元素，每个数组元素都有一个编号，编号从零开始。例如，数组值为[‘ John ‘,’ Doe ‘]，那么第2个元素可以通过数组名[1]进行引用</p>
</li>
</ul>
<h4 id="3-2-数据类型详解"><a href="#3-2-数据类型详解" class="headerlink" title="3.2 数据类型详解"></a>3.2 数据类型详解</h4><h5 id="3-2-1-数字类型"><a href="#3-2-1-数字类型" class="headerlink" title="3.2.1 数字类型"></a>3.2.1 数字类型</h5><p>TINYINT(1字节整数)<br>SMALLINT (2字节整数)<br>INT&#x2F;INTEGER (4字节整数)<br>BIGINT (8字节整数)<br>FLOAT (4字节浮点数)<br>DOUBLE (8字节双精度浮点数)</p>
<p>示例：<br><strong>create table t_test(a string ,b int,c bigint,d float,e double,f tinyint,g smallint)</strong></p>
<h5 id="3-2-2-时间类型"><a href="#3-2-2-时间类型" class="headerlink" title="3.2.2 时间类型"></a>3.2.2 时间类型</h5><p>TIMESTAMP（时间戳）–包含年月日时分毫秒的一种封装<br>DATE（日期）–只包含年月日<br></p>
<p>示例，假如有以下数据：<br>		1,zhangsan,1985-06-30<br>		2,lisi,1986-07-10<br>		3,wangwu,1985-08-09<br>那么，就可以建立一个表来对数据进行映射<br><strong>create table t_customer(id int, name string, birthday date)<br>row format delimited fields terminated by ‘,’;</strong><br>然后导入数据<br><strong>load data local inpath ‘&#x2F;root&#x2F;customer.dat’ into table t_customer;</strong></p>
<h5 id="3-2-3-字符串类型"><a href="#3-2-3-字符串类型" class="headerlink" title="3.2.3 字符串类型"></a>3.2.3 字符串类型</h5><p>STRING<br>VARCHAR(字符串1-65355长度，超长截断)<br>CHAR (字符串，最大长度255)</p>
<h5 id="3-2-4-其他类型"><a href="#3-2-4-其他类型" class="headerlink" title="3.2.4 其他类型"></a>3.2.4 其他类型</h5><p>BOOLEAN（布尔类型）：true false<br>BINARY (二进制数组)</p>
<h5 id="3-2-5-集合类型"><a href="#3-2-5-集合类型" class="headerlink" title="3.2.5 集合类型"></a>3.2.5 集合类型</h5><h6 id="3-2-5-1-STRUCT举例"><a href="#3-2-5-1-STRUCT举例" class="headerlink" title="3.2.5.1 STRUCT举例"></a>3.2.5.1 STRUCT举例</h6><p><figure class="image-caption"><img lazyload src="/images/loading.svg" data-src="https://cdn.jsdelivr.net/gh/xuanyin02/ImgHosting/article_img/image-20230427182958022.png" alt="image-20230427182958022"><figcaption>image-20230427182958022</figcaption></figure></p>
<h6 id="3-2-5-2-MAP举例"><a href="#3-2-5-2-MAP举例" class="headerlink" title="3.2.5.2 MAP举例"></a>3.2.5.2 MAP举例</h6><p><figure class="image-caption"><img lazyload src="/images/loading.svg" data-src="https://cdn.jsdelivr.net/gh/xuanyin02/ImgHosting/article_img/image-20230427182914489.png" alt="image-20230427182914489"><figcaption>image-20230427182914489</figcaption></figure></p>
<h6 id="3-2-5-3-ARRAY举例"><a href="#3-2-5-3-ARRAY举例" class="headerlink" title="3.2.5.3 ARRAY举例"></a>3.2.5.3 ARRAY举例</h6><p><figure class="image-caption"><img lazyload src="/images/loading.svg" data-src="https://cdn.jsdelivr.net/gh/xuanyin02/ImgHosting/article_img/image-20230427183049077.png" alt="image-20230427183049077"><figcaption>image-20230427183049077</figcaption></figure></p>
<h4 id="3-3-类型转换"><a href="#3-3-类型转换" class="headerlink" title="3.3 类型转换"></a>3.3 类型转换</h4><h5 id="3-3-1-隐式转换"><a href="#3-3-1-隐式转换" class="headerlink" title="3.3.1 隐式转换"></a>3.3.1 隐式转换</h5><p>粗粒度–&gt;细粒度</p>
<h5 id="3-3-2-使用CAST操作"><a href="#3-3-2-使用CAST操作" class="headerlink" title="3.3.2 使用CAST操作"></a>3.3.2 使用CAST操作</h5><p>例如 CAST(‘1’ AS INT)会把字符串’1’转换成整数1；如果强制类型转换失败，如执行 CAST(‘X’ AS INT)，表达式返回空值NULL</p>
<h3 id="第4章-DDL语言"><a href="#第4章-DDL语言" class="headerlink" title="第4章 DDL语言"></a>第4章 DDL语言</h3><h4 id="4-1-创建数据库"><a href="#4-1-创建数据库" class="headerlink" title="4.1 创建数据库"></a>4.1 创建数据库</h4><pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">database</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> db_hive location <span class="token keyword">on</span> <span class="token string">'在hdfs上的位置'</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="4-2-查询数据库"><a href="#4-2-查询数据库" class="headerlink" title="4.2 查询数据库"></a>4.2 查询数据库</h4><pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">//显示数据库</span>
<span class="token keyword">show</span> <span class="token keyword">databases</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//查询通配符匹配的数据库</span>
<span class="token keyword">show</span> <span class="token keyword">databases</span> <span class="token operator">like</span> <span class="token string">'db_hive*'</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//显示数据库详细信息</span>
<span class="token keyword">desc</span> <span class="token keyword">database</span> <span class="token punctuation">[</span>extend<span class="token punctuation">]</span> db_hive<span class="token punctuation">;</span>
</code></pre>
<h4 id="4-3-修改数据库"><a href="#4-3-修改数据库" class="headerlink" title="4.3 修改数据库"></a>4.3 修改数据库</h4><p>用户可以使用ALTER DATABASE命令为某个数据库的DBPROPERTIES设置键-值对属性值，来描述这个数据库的属性信息，不可以修改数据库元数据信息</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">alter</span> <span class="token keyword">database</span> db_hive <span class="token keyword">set</span> dbproperties<span class="token punctuation">(</span><span class="token string">'createtime'</span><span class="token operator">=</span><span class="token string">'20170830'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="4-4-删除数据库"><a href="#4-4-删除数据库" class="headerlink" title="4.4 删除数据库"></a>4.4 删除数据库</h4><pre class=" language-sql"><code class="language-sql"><span class="token keyword">drop</span> <span class="token keyword">databases</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> db_hive<span class="token punctuation">;</span> 

<span class="token comment" spellcheck="true">//如果数据库不为空，可以采用cascade命令，级联删除</span>
<span class="token keyword">drop</span> <span class="token keyword">database</span> db_hive <span class="token keyword">cascade</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="4-5-创建表"><a href="#4-5-创建表" class="headerlink" title="4.5 创建表"></a>4.5 创建表</h4><pre class=" language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token punctuation">[</span>EXTERNAL<span class="token punctuation">]</span> <span class="token keyword">TABLE</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> table_name 	<span class="token comment" spellcheck="true">//①EXTERNAL关键字可以让用户创建一个外部表，在建表的同时指定一个指向实际数据的路径（LOCATION），Hive创建内部表时，会将数据移动到数据仓库指向的路径；若创建外部表，仅记录数据所在的路径，不对数据的位置做任何改变。在删除表的时候，内部表的元数据和数据会被一起删除，而外部表只删除元数据，不删除数据。</span>
<span class="token punctuation">[</span><span class="token punctuation">(</span>col_name data_type <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> col_comment<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span> 
<span class="token punctuation">[</span><span class="token keyword">COMMENT</span> table_comment<span class="token punctuation">]</span> 	<span class="token comment" spellcheck="true">//COMMENT：为表和列添加注释。</span>

<span class="token punctuation">[</span>PARTITIONED <span class="token keyword">BY</span> <span class="token punctuation">(</span>col_name data_type <span class="token punctuation">[</span><span class="token keyword">COMMENT</span> col_comment<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span>	<span class="token comment" spellcheck="true">//PARTITIONED BY创建分区表</span>
<span class="token punctuation">[</span><span class="token keyword">CLUSTERED</span> <span class="token keyword">BY</span> <span class="token punctuation">(</span>col_name<span class="token punctuation">,</span> col_name<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span>	<span class="token comment" spellcheck="true">//CLUSTERED BY创建分桶表</span>
<span class="token punctuation">[</span>SORTED <span class="token keyword">BY</span> <span class="token punctuation">(</span>col_name <span class="token punctuation">[</span><span class="token keyword">ASC</span><span class="token operator">|</span><span class="token keyword">DESC</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">INTO</span> num_buckets BUCKETS<span class="token punctuation">]</span> 	<span class="token comment" spellcheck="true">//SORTED BY不常用</span>

<span class="token punctuation">[</span><span class="token keyword">ROW</span> FORMAT row_format<span class="token punctuation">]</span>   <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated by</span> “分隔符”
<span class="token punctuation">[</span>STORED <span class="token keyword">AS</span> file_format<span class="token punctuation">]</span>	<span class="token comment" spellcheck="true">//STORED AS指定存储文件类型。常用的存储文件类型：SEQUENCEFILE（hadoop_kv序列文件）、TEXTFILE（文本）、RCFILE（列式存储格式文件）、PARQUETFILE(列式存储文件）。如果文件数据是纯文本，可以使用STORED AS TEXTFILE。如果数据需要压缩，使用 STORED AS SEQUENCEFILE。</span>
<span class="token punctuation">[</span>LOCATION hdfs_path<span class="token punctuation">]</span>	<span class="token comment" spellcheck="true">//LOCATION ：指定表在HDFS上的存储位置。</span>
<span class="token punctuation">[</span><span class="token operator">LIKE</span><span class="token punctuation">]</span>	<span class="token comment" spellcheck="true">//LIKE允许用户复制现有的表结构，但是不复制数据.</span>
</code></pre>
<h5 id="4-5-1-内部表（也称“管理表”）"><a href="#4-5-1-内部表（也称“管理表”）" class="headerlink" title="4.5.1 内部表（也称“管理表”）"></a>4.5.1 内部表（也称“管理表”）</h5><p>在上面代码块中的第①个解释中已说明</p>
<h5 id="4-5-2-外部表"><a href="#4-5-2-外部表" class="headerlink" title="4.5.2 外部表"></a>4.5.2 外部表</h5><p>同上</p>
<h5 id="4-5-3-内部表与外部表的互相转换"><a href="#4-5-3-内部表与外部表的互相转换" class="headerlink" title="4.5.3 内部表与外部表的互相转换"></a>4.5.3 内部表与外部表的互相转换</h5><pre class=" language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">//查询student1、student2表的类型</span>
<span class="token keyword">desc</span> formatted student1<span class="token punctuation">;</span><span class="token comment" spellcheck="true">--内部表</span>
<span class="token keyword">desc</span> formatted student2<span class="token punctuation">;</span><span class="token comment" spellcheck="true">--外部表</span>
<span class="token comment" spellcheck="true">//修改内部表student1为外部表</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> student <span class="token keyword">set</span> tblproperties<span class="token punctuation">(</span><span class="token string">'EXTERNAL'</span><span class="token operator">=</span><span class="token string">'TRUE'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">//修改外部表student2为内部表</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> student2 <span class="token keyword">set</span> tblproperties<span class="token punctuation">(</span><span class="token string">'EXTERNAL'</span><span class="token operator">=</span><span class="token string">'FALSE'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

注意：<span class="token punctuation">(</span><span class="token string">'EXTERNAL'</span><span class="token operator">=</span><span class="token string">'TRUE'</span><span class="token punctuation">)</span>和<span class="token punctuation">(</span><span class="token string">'EXTERNAL'</span><span class="token operator">=</span><span class="token string">'FALSE'</span><span class="token punctuation">)</span>为固定写法，区分大小写！
</code></pre>
<h4 id="4-6-分区表"><a href="#4-6-分区表" class="headerlink" title="4.6 分区表"></a>4.6 分区表</h4><p>hive中的分区就是分目录</p>
<h5 id="4-6-1-静态分区"><a href="#4-6-1-静态分区" class="headerlink" title="4.6.1 静态分区"></a>4.6.1 静态分区</h5><p>创建静态分区表语法</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> 表名 <span class="token keyword">partition</span><span class="token punctuation">(</span>字段名 字段类型<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> partitioned <span class="token keyword">by</span><span class="token punctuation">(</span>分区字段名 分区字段类型<span class="token punctuation">)</span>
<span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated by</span> <span class="token string">'\t'</span><span class="token punctuation">;</span>
</code></pre>
<p>加载数据到分区表中</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">load</span> <span class="token keyword">data</span> <span class="token keyword">local</span> inpath <span class="token string">'本地文件路径'</span> <span class="token keyword">into</span> <span class="token keyword">table</span> 数据库名<span class="token punctuation">.</span>表名 <span class="token keyword">partition</span><span class="token punctuation">(</span>分区字段名<span class="token operator">=</span><span class="token string">'分区字段值'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>增加分区</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> 表名 <span class="token keyword">add</span> <span class="token keyword">partition</span><span class="token punctuation">(</span>分区字段名<span class="token operator">=</span><span class="token string">'分区字段值1'</span><span class="token punctuation">)</span> <span class="token keyword">partition</span><span class="token punctuation">(</span>分区字段名<span class="token operator">=</span><span class="token string">'分区字段值2'</span><span class="token punctuation">)</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
</code></pre>
<p>删除分区</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">alter</span> <span class="token keyword">table</span> 表名 <span class="token keyword">drop</span> <span class="token keyword">partition</span><span class="token punctuation">(</span>分区字段名<span class="token operator">=</span><span class="token string">'分区字段值1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token keyword">partition</span><span class="token punctuation">(</span>分区字段名<span class="token operator">=</span><span class="token string">'分区字段值2'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
</code></pre>
<p>查看分区表分区</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">show</span> partitions 表名<span class="token punctuation">;</span>
</code></pre>
<p>多级分区：partitioned by 多个分区字段</p>
<p>把数据导入分区的三种方式：<br>(1)方式1：上传数据后修复<br>(2)方式2：上传数据后添加分区<br>(3)方式3：创建文件夹后load数据到分区</p>
<h5 id="4-6-2-动态分区"><a href="#4-6-2-动态分区" class="headerlink" title="4.6.2 动态分区"></a>4.6.2 动态分区</h5><p>按照某个字段的不同值自动将数据加载到不同分区中</p>
<p>创建动态分区表</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">database</span> 表名<span class="token punctuation">(</span>字段名 字段类型<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> partitioned <span class="token keyword">by</span><span class="token punctuation">(</span>分区字段名 分区字段类型<span class="token punctuation">)</span>
<span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated by</span> <span class="token string">'\t'</span><span class="token punctuation">;</span>
</code></pre>
<p>设置开启动态分区参数</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">.</span>dynamic<span class="token punctuation">.</span><span class="token keyword">partition</span><span class="token operator">=</span><span class="token boolean">true</span> <span class="token comment" spellcheck="true">//使用动态分区</span>
<span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">.</span>dynamic<span class="token punctuation">.</span><span class="token keyword">partition</span><span class="token punctuation">.</span>mode<span class="token operator">=</span>nonstrick<span class="token punctuation">;</span><span class="token comment" spellcheck="true">//无限制模式，如果模式是strict，则必须有一个静态分区且放在最前面</span>
<span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">.</span>max<span class="token punctuation">.</span>dynamic<span class="token punctuation">.</span>partitions<span class="token punctuation">.</span>pernode<span class="token operator">=</span><span class="token number">10000</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//每个节点生成动态分区的最大个数</span>
<span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">.</span>max<span class="token punctuation">.</span>dynamic<span class="token punctuation">.</span>partitions<span class="token operator">=</span><span class="token number">100000</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//生成动态分区的最大个数</span>
<span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">exec</span><span class="token punctuation">.</span>max<span class="token punctuation">.</span>created<span class="token punctuation">.</span>files<span class="token operator">=</span><span class="token number">150000</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//一个任务最多可以创建的文件数目</span>
<span class="token keyword">set</span> dfs<span class="token punctuation">.</span>datanode<span class="token punctuation">.</span>max<span class="token punctuation">.</span>xcievers<span class="token operator">=</span><span class="token number">8192</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//限定一次最多打开的文件数</span>
<span class="token keyword">set</span> hive<span class="token punctuation">.</span><span class="token keyword">merge</span><span class="token punctuation">.</span>mapfiles<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// map端的结果进行合并</span>
<span class="token keyword">set</span> mapreduce<span class="token punctuation">.</span>reduce<span class="token punctuation">.</span>tasks <span class="token operator">=</span><span class="token number">20000</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//设置reduce task个数  增加reduce阶段的并行度</span>
</code></pre>
<p>加载数据</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span>  <span class="token keyword">table</span> demo2 <span class="token keyword">partition</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">--此处的分区变量x应该跟demo2中的分区变量名一致</span>
<span class="token keyword">select</span> id<span class="token punctuation">,</span> cost<span class="token punctuation">,</span> birthday <span class="token keyword">from</span> demo<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">--select中的最后一个表达式birthday，会作为分区变量x的动态值，注意顺序</span>
</code></pre>
<p>4.8 SerDe组件</p>
<p>SerDe是Serialize&#x2F;Deserilize的简称，目的是用于序列化和反序列化。<br>用户在建表时可以用自定义的SerDe或使用Hive自带的SerDe，SerDe能为表切分、解析列，且对列指定相应的数据。</p>
<p>创建表</p>
<pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> 表名<span class="token punctuation">(</span>字段名 字段类型<span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token keyword">row</span> format serde <span class="token string">'org.apache.hadoop.hive.serde2.RegexSerDe'</span> 
<span class="token keyword">with</span> serdeproperties <span class="token punctuation">(</span><span class="token string">"input.regex"</span> <span class="token operator">=</span> <span class="token string">"id=(.*),name=(.*)"</span><span class="token punctuation">)</span> 
stored <span class="token keyword">as</span> textfile<span class="token punctuation">;</span>
</code></pre>
<h3 id="第5章-数据导入导出操作"><a href="#第5章-数据导入导出操作" class="headerlink" title="第5章 数据导入导出操作"></a>第5章 数据导入导出操作</h3><h4 id="5-1-数据导入"><a href="#5-1-数据导入" class="headerlink" title="5.1 数据导入"></a>5.1 数据导入</h4><h5 id="5-1-1-使用load向表中装载数据"><a href="#5-1-1-使用load向表中装载数据" class="headerlink" title="5.1.1 使用load向表中装载数据"></a>5.1.1 使用load向表中装载数据</h5><pre class=" language-SQL"><code class="language-SQL">load data [local] inpath '/opt/module/datas/student.txt' [overwrite] into table student [partition (partcol1=val1,…)];
</code></pre>
<ol>
<li>load data：表示加载数据</li>
<li>local：表示从本地加载数据到hive表；否则从HDFS加载数据到hive表</li>
<li>inpath：表示加载数据的路径</li>
<li>overwrite：表示覆盖表中已有数据，否则表示追加</li>
<li>into table：表示加载到哪张表</li>
<li>student：表示具体的表</li>
<li>partition：表示上传到指定分区</li>
</ol>
<h5 id="5-1-2-使用insert…values向表中插入数据"><a href="#5-1-2-使用insert…values向表中插入数据" class="headerlink" title="5.1.2 使用insert…values向表中插入数据"></a>5.1.2 使用insert…values向表中插入数据</h5><pre class=" language-sql"><code class="language-sql"><span class="token keyword">insert</span> <span class="token keyword">into</span> <span class="token keyword">table</span>  student1 <span class="token keyword">partition</span><span class="token punctuation">(</span>month<span class="token operator">=</span><span class="token string">'201709'</span><span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'wangwu'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h5 id="5-1-3-使用insert…select向表中插入数据"><a href="#5-1-3-使用insert…select向表中插入数据" class="headerlink" title="5.1.3 使用insert…select向表中插入数据"></a>5.1.3 使用insert…select向表中插入数据</h5><pre class=" language-sql"><code class="language-sql"><span class="token keyword">insert</span> overwrite <span class="token keyword">table</span> student2 <span class="token keyword">partition</span><span class="token punctuation">(</span>month<span class="token operator">=</span><span class="token string">'201708'</span><span class="token punctuation">)</span> <span class="token keyword">select</span> id<span class="token punctuation">,</span> name <span class="token keyword">from</span> student1 <span class="token keyword">where</span> month<span class="token operator">=</span><span class="token string">'201709'</span><span class="token punctuation">;</span>
</code></pre>
<h5 id="5-1-4-用create-as创建表并加载数据"><a href="#5-1-4-用create-as创建表并加载数据" class="headerlink" title="5.1.4 用create as创建表并加载数据"></a>5.1.4 用create as创建表并加载数据</h5><pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> student3
<span class="token keyword">as</span> 
<span class="token keyword">select</span> id<span class="token punctuation">,</span> name <span class="token keyword">from</span> student<span class="token punctuation">;</span>
</code></pre>
<h5 id="5-1-5-创建表时通过指定location加载数据路径"><a href="#5-1-5-创建表时通过指定location加载数据路径" class="headerlink" title="5.1.5 创建表时通过指定location加载数据路径"></a>5.1.5 创建表时通过指定location加载数据路径</h5><pre class=" language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token operator">not</span> <span class="token keyword">exists</span> student4<span class="token punctuation">(</span>id <span class="token keyword">int</span><span class="token punctuation">,</span> name string<span class="token punctuation">)</span> <span class="token keyword">row</span> format delimited <span class="token keyword">fields</span> <span class="token keyword">terminated by</span> <span class="token string">'\t'</span> location <span class="token string">'/user/hive/warehouse/student4'</span><span class="token punctuation">;</span>
</code></pre>
<h5 id="5-1-6-import数据到指定Hive表中"><a href="#5-1-6-import数据到指定Hive表中" class="headerlink" title="5.1.6 import数据到指定Hive表中"></a>5.1.6 import数据到指定Hive表中</h5><pre class=" language-sql"><code class="language-sql"><span class="token keyword">import</span> <span class="token keyword">table</span> student2 <span class="token keyword">partition</span><span class="token punctuation">(</span>month<span class="token operator">=</span><span class="token string">'201709'</span><span class="token punctuation">)</span> <span class="token keyword">from</span> <span class="token string">'/user/hive/warehouse/export/student'</span><span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p>注意：先用export导出后，再将数据导入</p>
</blockquote>
<h4 id="5-2-数据导出"><a href="#5-2-数据导出" class="headerlink" title="5.2 数据导出"></a>5.2 数据导出</h4><h5 id="5-2-1-insert导出"><a href="#5-2-1-insert导出" class="headerlink" title="5.2.1 insert导出"></a>5.2.1 insert导出</h5><pre class=" language-sql"><code class="language-sql"><span class="token keyword">insert</span> overwrite <span class="token punctuation">[</span><span class="token keyword">local</span><span class="token punctuation">]</span> directory <span class="token string">'/opt/module/datas/export/student1'</span>
<span class="token keyword">ROW</span> FORMAT DELIMITED <span class="token keyword">FIELDS</span> <span class="token keyword">TERMINATED BY</span> <span class="token string">'\t'</span>             
<span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> student<span class="token punctuation">;</span>
</code></pre>
<h5 id="5-2-2-export导出到HDFS上"><a href="#5-2-2-export导出到HDFS上" class="headerlink" title="5.2.2 export导出到HDFS上"></a>5.2.2 export导出到HDFS上</h5><pre class=" language-sql"><code class="language-sql">export <span class="token keyword">table</span> <span class="token keyword">default</span><span class="token punctuation">.</span>student <span class="token keyword">to</span> <span class="token string">'/user/hive/warehouse/export/student'</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="5-3-清除表中数据（Truncate）"><a href="#5-3-清除表中数据（Truncate）" class="headerlink" title="5.3 清除表中数据（Truncate）"></a>5.3 清除表中数据（Truncate）</h4><pre class=" language-sql"><code class="language-sql"> <span class="token keyword">truncate</span> <span class="token keyword">table</span> student<span class="token punctuation">;</span>
</code></pre>
<blockquote>
<p>注意：Truncate只能删除管理表（内部表），不能删除外部表中数据</p>
</blockquote>

            </div>

            
                <div class="post-copyright-info">
                    <div class="article-copyright-info-container">
    <ul>
        <li><strong>标题:</strong> 关于数据仓库hive知识的学习</li>
        <li><strong>作者:</strong> 宣胤</li>
        <li><strong>创建于:</strong> 2023-04-27 16:24:33</li>
        
            <li>
                <strong>更新于:</strong> 2023-05-14 22:54:55
            </li>
        
        <li>
            <strong>链接:</strong> http://xuanyin02.github.io/2023/042713923.html
        </li>
        <li>
            <strong>版权声明:</strong> 本文章采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA 4.0</a> 进行许可。
        </li>
    </ul>
</div>

                </div>
            

            
                <ul class="post-tags-box">
                    
                        <li class="tag-item">
                            <a href="/tags/hive/">#hive</a>&nbsp;
                        </li>
                    
                </ul>
            

            

            
                <div class="article-nav">
                    
                        <div class="article-prev">
                            <a class="prev"
                            rel="prev"
                            href="/2023/042717719.html"
                            >
                                <span class="left arrow-icon flex-center">
                                    <i class="fa-solid fa-chevron-left"></i>
                                </span>
                                <span class="title flex-center">
                                    <span class="post-nav-title-item">关于实时计算框架flink知识的学习</span>
                                    <span class="post-nav-item">上一篇</span>
                                </span>
                            </a>
                        </div>
                    
                    
                        <div class="article-next">
                            <a class="next"
                            rel="next"
                            href="/2023/042646735.html"
                            >
                                <span class="title flex-center">
                                    <span class="post-nav-title-item">那些年我做过的“学习用”项目</span>
                                    <span class="post-nav-item">下一篇</span>
                                </span>
                                <span class="right arrow-icon flex-center">
                                    <i class="fa-solid fa-chevron-right"></i>
                                </span>
                            </a>
                        </div>
                    
                </div>
            


            
                <div class="comment-container">
                    <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        <i class="fa-solid fa-comments"></i>&nbsp;评论
    </div>
    

        
            
 
    <div id="waline"></div>
    <script type="module"  data-pjax>
        import { init } from 'https://evan.beee.top/js/waline.mjs';

        function loadWaline() {
            init({
                el: '#waline',
                serverURL: 'https://example.example.com',
                lang: 'zh-CN',
                dark: 'body[class~="dark-mode"]',
                requiredMeta: ['nick','mail'], // cannot customize by theme config, change it yourself
            });
        }

        if ('true') {
            const loadWalineTimeout = setTimeout(() => {
                loadWaline();
                clearTimeout(loadWalineTimeout);
            }, 1000);
        } else {
            window.addEventListener('DOMContentLoaded', loadWaline);
        }
        
    </script>



        
    
</div>

                </div>
            
        </div>

        
            <div class="toc-content-container">
                <div class="post-toc-wrap">
    <div class="post-toc">
        <div class="toc-title">此页目录</div>
        <div class="page-title">关于数据仓库hive知识的学习</div>
        <ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC1%E7%AB%A0-hive%E5%85%A5%E9%97%A8"><span class="nav-number">1.</span> <span class="nav-text">第1章 hive入门</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-%E4%BB%80%E4%B9%88%E6%98%AFhive"><span class="nav-number">1.1.</span> <span class="nav-text">1.1 什么是hive</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-hive%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="nav-number">1.2.</span> <span class="nav-text">1.2 hive的优缺点</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BC%98%E7%82%B9"><span class="nav-number">1.2.1.</span> <span class="nav-text">优点</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BC%BA%E7%82%B9"><span class="nav-number">1.2.2.</span> <span class="nav-text">缺点</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-3-hive%E7%9A%84%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-number">1.3.</span> <span class="nav-text">1.3 hive的应用场景</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-4-hive%E6%9E%B6%E6%9E%84%E5%8F%8A%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="nav-number">1.4.</span> <span class="nav-text">1.4 hive架构及工作原理</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#hive%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="nav-number">1.4.1.</span> <span class="nav-text">hive工作原理</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-5-hive%E5%92%8C%E4%BC%A0%E7%BB%9F%E6%95%B0%E6%8D%AE%E5%BA%93%E6%AF%94%E8%BE%83"><span class="nav-number">1.5.</span> <span class="nav-text">1.5 hive和传统数据库比较</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC2%E7%AB%A0-hive%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2"><span class="nav-number">2.</span> <span class="nav-text">第2章 hive安装部署</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC3%E7%AB%A0-hive%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">3.</span> <span class="nav-text">第3章 hive数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-1-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E6%A6%82%E8%BF%B0"><span class="nav-number">3.1.</span> <span class="nav-text">3.1 数据类型概述</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#3-1-1-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">3.1.1.</span> <span class="nav-text">3.1.1 基本数据类型</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-1-2-%E9%9B%86%E5%90%88%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">3.1.2.</span> <span class="nav-text">3.1.2 集合数据类型</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-2-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E8%AF%A6%E8%A7%A3"><span class="nav-number">3.2.</span> <span class="nav-text">3.2 数据类型详解</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#3-2-1-%E6%95%B0%E5%AD%97%E7%B1%BB%E5%9E%8B"><span class="nav-number">3.2.1.</span> <span class="nav-text">3.2.1 数字类型</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-2-2-%E6%97%B6%E9%97%B4%E7%B1%BB%E5%9E%8B"><span class="nav-number">3.2.2.</span> <span class="nav-text">3.2.2 时间类型</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-2-3-%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E5%9E%8B"><span class="nav-number">3.2.3.</span> <span class="nav-text">3.2.3 字符串类型</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-2-4-%E5%85%B6%E4%BB%96%E7%B1%BB%E5%9E%8B"><span class="nav-number">3.2.4.</span> <span class="nav-text">3.2.4 其他类型</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-2-5-%E9%9B%86%E5%90%88%E7%B1%BB%E5%9E%8B"><span class="nav-number">3.2.5.</span> <span class="nav-text">3.2.5 集合类型</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#3-2-5-1-STRUCT%E4%B8%BE%E4%BE%8B"><span class="nav-number">3.2.5.1.</span> <span class="nav-text">3.2.5.1 STRUCT举例</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-2-5-2-MAP%E4%B8%BE%E4%BE%8B"><span class="nav-number">3.2.5.2.</span> <span class="nav-text">3.2.5.2 MAP举例</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#3-2-5-3-ARRAY%E4%B8%BE%E4%BE%8B"><span class="nav-number">3.2.5.3.</span> <span class="nav-text">3.2.5.3 ARRAY举例</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-3-%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="nav-number">3.3.</span> <span class="nav-text">3.3 类型转换</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#3-3-1-%E9%9A%90%E5%BC%8F%E8%BD%AC%E6%8D%A2"><span class="nav-number">3.3.1.</span> <span class="nav-text">3.3.1 隐式转换</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-3-2-%E4%BD%BF%E7%94%A8CAST%E6%93%8D%E4%BD%9C"><span class="nav-number">3.3.2.</span> <span class="nav-text">3.3.2 使用CAST操作</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC4%E7%AB%A0-DDL%E8%AF%AD%E8%A8%80"><span class="nav-number">4.</span> <span class="nav-text">第4章 DDL语言</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#4-1-%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">4.1.</span> <span class="nav-text">4.1 创建数据库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-2-%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">4.2.</span> <span class="nav-text">4.2 查询数据库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-3-%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">4.3.</span> <span class="nav-text">4.3 修改数据库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-4-%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">4.4.</span> <span class="nav-text">4.4 删除数据库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-5-%E5%88%9B%E5%BB%BA%E8%A1%A8"><span class="nav-number">4.5.</span> <span class="nav-text">4.5 创建表</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#4-5-1-%E5%86%85%E9%83%A8%E8%A1%A8%EF%BC%88%E4%B9%9F%E7%A7%B0%E2%80%9C%E7%AE%A1%E7%90%86%E8%A1%A8%E2%80%9D%EF%BC%89"><span class="nav-number">4.5.1.</span> <span class="nav-text">4.5.1 内部表（也称“管理表”）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-5-2-%E5%A4%96%E9%83%A8%E8%A1%A8"><span class="nav-number">4.5.2.</span> <span class="nav-text">4.5.2 外部表</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-5-3-%E5%86%85%E9%83%A8%E8%A1%A8%E4%B8%8E%E5%A4%96%E9%83%A8%E8%A1%A8%E7%9A%84%E4%BA%92%E7%9B%B8%E8%BD%AC%E6%8D%A2"><span class="nav-number">4.5.3.</span> <span class="nav-text">4.5.3 内部表与外部表的互相转换</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-6-%E5%88%86%E5%8C%BA%E8%A1%A8"><span class="nav-number">4.6.</span> <span class="nav-text">4.6 分区表</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#4-6-1-%E9%9D%99%E6%80%81%E5%88%86%E5%8C%BA"><span class="nav-number">4.6.1.</span> <span class="nav-text">4.6.1 静态分区</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-6-2-%E5%8A%A8%E6%80%81%E5%88%86%E5%8C%BA"><span class="nav-number">4.6.2.</span> <span class="nav-text">4.6.2 动态分区</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC5%E7%AB%A0-%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA%E6%93%8D%E4%BD%9C"><span class="nav-number">5.</span> <span class="nav-text">第5章 数据导入导出操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%85%A5"><span class="nav-number">5.1.</span> <span class="nav-text">5.1 数据导入</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1-1-%E4%BD%BF%E7%94%A8load%E5%90%91%E8%A1%A8%E4%B8%AD%E8%A3%85%E8%BD%BD%E6%95%B0%E6%8D%AE"><span class="nav-number">5.1.1.</span> <span class="nav-text">5.1.1 使用load向表中装载数据</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1-2-%E4%BD%BF%E7%94%A8insert%E2%80%A6values%E5%90%91%E8%A1%A8%E4%B8%AD%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="nav-number">5.1.2.</span> <span class="nav-text">5.1.2 使用insert…values向表中插入数据</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1-3-%E4%BD%BF%E7%94%A8insert%E2%80%A6select%E5%90%91%E8%A1%A8%E4%B8%AD%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="nav-number">5.1.3.</span> <span class="nav-text">5.1.3 使用insert…select向表中插入数据</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1-4-%E7%94%A8create-as%E5%88%9B%E5%BB%BA%E8%A1%A8%E5%B9%B6%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE"><span class="nav-number">5.1.4.</span> <span class="nav-text">5.1.4 用create as创建表并加载数据</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1-5-%E5%88%9B%E5%BB%BA%E8%A1%A8%E6%97%B6%E9%80%9A%E8%BF%87%E6%8C%87%E5%AE%9Alocation%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE%E8%B7%AF%E5%BE%84"><span class="nav-number">5.1.5.</span> <span class="nav-text">5.1.5 创建表时通过指定location加载数据路径</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-1-6-import%E6%95%B0%E6%8D%AE%E5%88%B0%E6%8C%87%E5%AE%9AHive%E8%A1%A8%E4%B8%AD"><span class="nav-number">5.1.6.</span> <span class="nav-text">5.1.6 import数据到指定Hive表中</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%87%BA"><span class="nav-number">5.2.</span> <span class="nav-text">5.2 数据导出</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#5-2-1-insert%E5%AF%BC%E5%87%BA"><span class="nav-number">5.2.1.</span> <span class="nav-text">5.2.1 insert导出</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-2-2-export%E5%AF%BC%E5%87%BA%E5%88%B0HDFS%E4%B8%8A"><span class="nav-number">5.2.2.</span> <span class="nav-text">5.2.2 export导出到HDFS上</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-3-%E6%B8%85%E9%99%A4%E8%A1%A8%E4%B8%AD%E6%95%B0%E6%8D%AE%EF%BC%88Truncate%EF%BC%89"><span class="nav-number">5.3.</span> <span class="nav-text">5.3 清除表中数据（Truncate）</span></a></li></ol></li></ol>

    </div>
</div>
            </div>
        
    </div>
</div>


                

            </div>
            
            

        </div>

        <div class="main-content-footer">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info">
            &copy;
            
              <span>2023</span>
              -
            
            2023&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">宣胤</a>
        </div>
        
            <script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="website-count info-item">
                
                    <span id="busuanzi_container_site_uv" class="busuanzi_container_site_uv">
                        访问人数&nbsp;<span id="busuanzi_value_site_uv" class="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="busuanzi_container_site_pv">
                        总访问量&nbsp;<span id="busuanzi_value_site_pv" class="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="theme-info info-item">
            <span class="powered-by-container">由 <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" href="https://hexo.io">Hexo</a> 驱动</span>
                <br>
            <span class="theme-version-container">主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.1.4</a>
        </div>
        
        
        
            <div id="start_div" style="display:none">
                2023/4/13 00:00:00
            </div>
            <div>
                博客已运行 <span class="odometer" id="runtime_days" ></span> 天 <span class="odometer" id="runtime_hours"></span> 小时 <span class="odometer" id="runtime_minutes"></span> 分钟 <span class="odometer" id="runtime_seconds"></span> 秒
            </div>
        
        
        
            <script async data-pjax>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="article-tools-list">
        <!-- TOC aside toggle -->
        
            <li class="right-bottom-tools page-aside-toggle">
                <i class="fa-regular fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fa-regular fa-comments"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-side-tools-container">
        <div class="side-tools-container">
    <ul class="hidden-tools-list">
        <li class="right-bottom-tools tool-font-adjust-plus flex-center">
            <i class="fa-regular fa-magnifying-glass-plus"></i>
        </li>

        <li class="right-bottom-tools tool-font-adjust-minus flex-center">
            <i class="fa-regular fa-magnifying-glass-minus"></i>
        </li>

        <li class="right-bottom-tools tool-expand-width flex-center">
            <i class="fa-regular fa-expand"></i>
        </li>

        <li class="right-bottom-tools tool-dark-light-toggle flex-center">
            <i class="fa-regular fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="right-bottom-tools tool-scroll-to-bottom flex-center">
            <i class="fa-regular fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="visible-tools-list">
        <li class="right-bottom-tools toggle-tools-list flex-center">
            <i class="fa-regular fa-cog fa-spin"></i>
        </li>
        
            <li class="right-bottom-tools tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fa-solid fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fa-solid fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    


</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/layouts/navbarShrink.js"></script>

<script src="/js/tools/scrollTopBottom.js"></script>

<script src="/js/tools/lightDarkSwitch.js"></script>



    
<script src="/js/tools/localSearch.js"></script>




    
<script src="/js/tools/codeBlock.js"></script>




    
<script src="/js/layouts/lazyload.js"></script>




    
<script src="/js/tools/runtime.js"></script>

    
<script src="/js/layouts/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/libs/Typed.min.js"></script>

  
<script src="/js/plugins/typed.js"></script>







<div class="post-scripts pjax">
    
        
<script src="/js/tools/tocToggle.js"></script>

<script src="/js/libs/anime.min.js"></script>

<script src="/js/layouts/toc.js"></script>

<script src="/js/plugins/tabs.js"></script>

    
</div>


    
<script src="/js/libs/pjax.min.js"></script>

<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax',
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
            // scrollTo: true,
        });

        document.addEventListener('pjax:send', () => {
            Global.utils.pjaxProgressBarStart();
        });

        document.addEventListener('pjax:complete', () => {
            Global.utils.pjaxProgressBarEnd();
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
            Global.refresh();
        });
    });
</script>




    <div id="aplayer"></div>

<script src="/js/libs/APlayer.min.js"></script>


<script src="/js/plugins/aplayer.js"></script>


</body>
</html>
